!function(){function e(e,t){window.XMLHttpRequest.prototype[e]=t(window.XMLHttpRequest.prototype[e])}function t(e,t,n,r,a,o,l){function u(){return"input"===t[0].tagName.toLowerCase()&&t.attr("type")&&"file"===t.attr("type").toLowerCase()}function c(n){o(function(){t.parent().length&&v.push(e.$watch(n,function(e,t){e!=t&&f()}))})}function f(){var n=t.clone();if(t.attr("__afu_gen__")&&angular.element(document.getElementById(t.attr("id").substring(1))).remove(),t.parent().length){for(var r=0;r<v.length;r++)v[r]();t.replaceWith(n),l(n)(e)}return n}function s(r,i){if(r){c(r);var o=a(r)(e);o?(t.attr(i,o),n[i]=o):(t.attr(i,null),delete n[i])}}function p(t){var a;a=t.__files_||t.target&&t.target.files,g(a,n,r,e,t)}function d(e){var n=null!=h[0].value&&""!=h[0].value;if(h[0].value=null,-1===navigator.userAgent.indexOf("Chrome"))if(t.attr("__afu_clone__"))t.attr("__afu_clone__",null);else if(n&&p({target:{files:[]}}),-1!==navigator.appVersion.indexOf("MSIE 10")){var r=f();return r.attr("__afu_clone__",!0),r[0].click(),e.preventDefault(),e.stopPropagation(),!0}}function g(e,t,n,r,l){for(var u=[],c=[],f=t.accept?new RegExp(i(t.accept),"gi"):null,s=0;s<e.length;s++){var p=e.item(s);!f||p.type.match(f)||null!=p.name&&p.name.match(f)?u.push(p):c.push(p)}n&&o(function(){r[t.ngModel]&&(r[t.ngModel].value=u),r[t.ngModel]=u,n&&n.$setViewValue(null!=u&&0==u.length?"":u),t.ngModelRejected&&(r[t.ngModelRejected]&&(r[t.ngModelRejected].value=c),r[t.ngModelRejected]=c)}),t.ngFileChange&&""!=t.ngFileChange&&o(function(){a(t.ngFileChange)(r,{$files:u,$rejectedFiles:c,$event:l})})}var v=[];s(n.ngMultiple,"multiple"),s(n.ngAccept,"accept"),s(n.ngCapture,"capture"),""!=n.ngFileSelect&&(n.ngFileChange=n.ngFileSelect);var h=t;if(u())t.bind("click",d);else{h=angular.element('<input type="file">'),n.multiple&&h.attr("multiple",n.multiple),n.accept&&h.attr("accept",n.accept),n.capture&&h.attr("capture",n.capture);for(var m in n)if(0==m.indexOf("inputFile")){var y=m.substring("inputFile".length);y=y[0].toLowerCase()+y.substring(1),h.attr(y,n[m])}h.css("width","0px").css("height","0px").css("position","absolute").css("padding",0).css("margin",0).css("overflow","hidden").attr("tabindex","-1").css("opacity",0).attr("__afu_gen__",!0),t.attr("__refElem__",!0),h[0].__refElem__=t[0],t.parent()[0].insertBefore(h[0],t[0]),t.css("overflow","hidden"),t.bind("click",function(e){d(e)||h[0].click()})}h.bind("change",p),t.on("$destroy",function(){for(var e=0;e<v.length;e++)v[e]();t[0]!=h[0]&&h.remove()}),v.push(e.$watch(n.ngModel,function(e,t){e==t||null!=e&&e.length||(-1!==navigator.appVersion.indexOf("MSIE 10")?f():h[0].value=null)}))}function n(e,t,n,o,l,u,c){function f(e,t,n){var r=!0;if(y){var a=n.dataTransfer.items;if(null!=a)for(var i=0;i<a.length&&r;i++)r=r&&("file"==a[i].kind||""==a[i].kind)&&(null!=a[i].type.match(y)||null!=a[i].name&&null!=a[i].name.match(y))}var o=l(t.dragOverClass)(e,{$event:n});return o&&(o.delay&&(h=o.delay),o.accept&&(o=r?o.accept:o.reject)),o||t.dragOverClass||"dragover"}function s(e,t,n,r){function i(e){!y||e.type.match(y)||null!=e.name&&e.name.match(y)?l.push(e):f.push(e)}function o(e,t,n){if(null!=t)if(t.isDirectory){var r=(n||"")+t.name;i({name:t.name,type:"directory",path:r});var a=t.createReader(),l=[];p++;var u=function(){a.readEntries(function(r){try{if(r.length)l=l.concat(Array.prototype.slice.call(r||[],0)),u();else{for(var a=0;a<l.length;a++)o(e,l[a],(n?n:"")+t.name+"/");p--}}catch(i){p--,console.error(i)}},function(){p--})};u()}else p++,t.file(function(e){try{p--,e.path=(n?n:"")+e.name,i(e)}catch(t){p--,console.error(t)}},function(){p--})}var l=[],f=[],s=e.dataTransfer.items,p=0;if(s&&s.length>0&&"file"!=c.protocol())for(var d=0;d<s.length;d++){if(s[d].webkitGetAsEntry&&s[d].webkitGetAsEntry()&&s[d].webkitGetAsEntry().isDirectory){var g=s[d].webkitGetAsEntry();if(g.isDirectory&&!n)continue;null!=g&&(a(g.name)?o(l,g):s[d].webkitGetAsEntry().isDirectory||i(s[d].getAsFile()))}else{var v=s[d].getAsFile();null!=v&&i(v)}if(!r&&l.length>0)break}else{var h=e.dataTransfer.files;if(null!=h)for(var d=0;d<h.length&&(i(h.item(d)),r||!(l.length>0));d++);}var m=0;!function _(e){u(function(){if(p)10*m++<2e4&&_(10);else{if(!r&&l.length>1){for(var e=0;"directory"==l[e].type;)e++;l=[l[e]]}t(l,f)}},e||0)}()}var p=r();if(n.dropAvailable&&u(function(){e.dropAvailable?e.dropAvailable.value=p:e.dropAvailable=p}),!p)return void(0!=l(n.hideOnDropNotAvailable)(e)&&t.css("display","none"));var d,g=null,v=l(n.stopPropagation)(e),h=1,m=l(n.ngAccept)(e)||n.accept,y=m?new RegExp(i(m),"gi"):null;t[0].addEventListener("dragover",function(r){r.preventDefault(),v&&r.stopPropagation();var a=r.dataTransfer.effectAllowed;r.dataTransfer.dropEffect="move"===a||"linkMove"===a?"move":"copy",u.cancel(g),e.actualDragOverClass||(d=f(e,n,r)),t.addClass(d)},!1),t[0].addEventListener("dragenter",function(e){e.preventDefault(),v&&e.stopPropagation()},!1),t[0].addEventListener("dragleave",function(){g=u(function(){t.removeClass(d),d=null},h||1)},!1),""!=n.ngFileDrop&&(n.ngFileChange=e.ngFileDrop),t[0].addEventListener("drop",function(r){r.preventDefault(),v&&r.stopPropagation(),t.removeClass(d),d=null,s(r,function(t,a){u(function(){o&&(e[n.ngModel]&&(e[n.ngModel].value=t),e[n.ngModel]=t,o&&o.$setViewValue(null!=t&&0==t.length?"":t)),n.ngModelRejected&&(e[n.ngModelRejected]&&(e[n.ngModelRejected].value=a),e[n.ngModelRejected]=a)}),u(function(){l(n.ngFileChange)(e,{$files:t,$rejectedFiles:a,$event:r})})},0!=l(n.allowDir)(e),n.multiple||l(n.ngMultiple)(e))},!1)}function r(){var e=document.createElement("div");return"draggable"in e&&"ondrop"in e}function a(e){return/^[\000-\177]*$/.test(e)}function i(e){if(e.length>2&&"/"===e[0]&&"/"===e[e.length-1])return e.substring(1,e.length-1);var t=e.split(","),n="";if(t.length>1)for(var r=0;r<t.length;r++)0==t[r].indexOf(".")&&(t[r]="*"+t[r]),n+="("+i(t[r])+")",r<t.length-1&&(n+="|");else n="^"+e.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",n=n.replace(/\\\*/g,".*").replace(/\\\?/g,".");return n}window.XMLHttpRequest&&!window.XMLHttpRequest.__isFileAPIShim&&e("setRequestHeader",function(e){return function(t,n){if("__setXHR_"===t){var r=n(this);r instanceof Function&&r(this)}else e.apply(this,arguments)}});var o=angular.module("angularFileUpload",[]);o.version="<%= pkg.version %>",o.service("$upload",["$http","$q","$timeout",function(e,t,n){function r(r){r.method=r.method||"POST",r.headers=r.headers||{},r.transformRequest=r.transformRequest||function(t,n){return window.ArrayBuffer&&t instanceof window.ArrayBuffer?t:e.defaults.transformRequest[0](t,n)};var a=t.defer(),i=a.promise;return r.headers.__setXHR_=function(){return function(e){e&&(r.__XHR=e,r.xhrFn&&r.xhrFn(e),e.upload.addEventListener("progress",function(e){e.config=r,a.notify?a.notify(e):i.progress_fn&&n(function(){i.progress_fn(e)})},!1),e.upload.addEventListener("load",function(e){e.lengthComputable&&(e.config=r,a.notify?a.notify(e):i.progress_fn&&n(function(){i.progress_fn(e)}))},!1))}},e(r).then(function(e){a.resolve(e)},function(e){a.reject(e)},function(e){a.notify(e)}),i.success=function(e){return i.then(function(t){e(t.data,t.status,t.headers,r)}),i},i.error=function(e){return i.then(null,function(t){e(t.data,t.status,t.headers,r)}),i},i.progress=function(e){return i.progress_fn=e,i.then(null,null,function(t){e(t)}),i},i.abort=function(){return r.__XHR&&n(function(){r.__XHR.abort()}),i},i.xhr=function(e){return r.xhrFn=function(t){return function(){t&&t.apply(i,arguments),e.apply(i,arguments)}}(r.xhrFn),i},i}this.upload=function(e){e.headers=e.headers||{},e.headers["Content-Type"]=void 0;e.transformRequest;return e.transformRequest=e.transformRequest?"[object Array]"===Object.prototype.toString.call(e.transformRequest)?e.transformRequest:[e.transformRequest]:[],e.transformRequest.push(function(t){var n=new FormData,r={};for(var a in e.fields)r[a]=e.fields[a];if(t&&(r.data=t),e.formDataAppender)for(var a in r)e.formDataAppender(n,a,r[a]);else for(var a in r){var i=r[a];void 0!==i&&("[object String]"===Object.prototype.toString.call(i)?n.append(a,i):e.sendObjectsAsJsonBlob&&"object"==typeof i?n.append(a,new Blob([i],{type:"application/json"})):n.append(a,JSON.stringify(i)))}if(null!=e.file){var o=e.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(e.file))for(var l="[object String]"===Object.prototype.toString.call(o),u=0;u<e.file.length;u++)n.append(l?o:o[u],e.file[u],e.fileName&&e.fileName[u]||e.file[u].name);else n.append(o,e.file,e.fileName||e.file.name)}return n}),r(e)},this.http=function(e){return r(e)}}]),o.directive("ngFileSelect",["$parse","$timeout","$compile",function(e,n,r){return{restrict:"AEC",require:"?ngModel",link:function(a,i,o,l){t(a,i,o,l,e,n,r)}}}]),o.directive("ngFileDrop",["$parse","$timeout","$location",function(e,t,r){return{restrict:"AEC",require:"?ngModel",link:function(a,i,o,l){n(a,i,o,l,e,t,r)}}}]),o.directive("ngNoFileDrop",function(){return function(e,t){r()&&t.css("display","none")}}),o.directive("ngFileDropAvailable",["$parse","$timeout",function(e,t){return function(n,a,i){if(r()){var o=e(i.ngFileDropAvailable);t(function(){o(n)})}}}]);var l=angular.module("ngFileUpload",[]);for(key in o)l[key]=o[key]}();